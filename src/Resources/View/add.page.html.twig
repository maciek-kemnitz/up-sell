
<html>
<head>
    {#<link rel="shortcut icon" href="{{ app.request.basepath }}/img/favicon.ico" />#}
    {#<link rel="stylesheet" type="text/css" href="{{ app.request.basepath }}/css/bootstrap.css">#}
    {#<link rel="stylesheet" type="text/css" href="{{ app.request.basepath }}/css/styles.css">#}
    <link rel="stylesheet" type="text/css" href="http://swiatmat.pl/css/fonts!admin-3376.css">
    <link rel="stylesheet" type="text/css" href="http://www.shoplo.com/css/admin!admin-4486067.css">
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/autosize.js/1.17.1/autosize-min.js"></script>
    <script src="http://www.shoplo.com/js/admin!admin-3376.js"></script>


    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jqueryui/1.8.24/jquery-ui.min.js"></script>
    <script src="{{ app.request.basepath }}/js/bootstrap.js"></script>
    {#<script src="{{ app.request.basepath }}/js/common.js"></script>#}
</head>
<body class="sidebar-collapsed">

<style>
    .close {
        float: right;
        font-size: 20px;
        font-weight: bold;
        line-height: 20px;
        color: #000000;
        text-shadow: 0 1px 0 #ffffff;
        opacity: 0.2;
        filter: alpha(opacity=20);
    }

    .space-right {
        margin-right: 20px;
    }

    .space-top {
        padding-top: 3px;
    }

    .autocompleter-area {
        width: 100%;
        height: 80px;
        border: 1px solid #1C1F27;
        border-top: none;
        position: absolute;
        background-color: white;
        left: -1px;
        z-index: 10;
    }

    .with-autocompleter-open {
        border-top: 1px solid #1C1F27;
        border-left: 1px solid #1C1F27;
        border-right: 1px solid #1C1F27;
        width: 100%;
        border-bottom: 1px solid #D5DAE2;
    }
</style>

<section class="main-container">

<section class="content-container">
    <section class="content-settings">
        <article class="content">
            <section class="scroll-area right-frame bottom-frame">
                <section class="box bottom-frame scroll-heading">
                    <h2>Dodaj ofertę</h2>
                </section>
                <section class="scroll-content">
                    <form action="/save/" method="post">
                        {% if upSell is defined %}<input name="upSellId" type="hidden" value="{{ upSell.getId() }}">{% endif %}
                        <table class="tabular">
                            <tbody>
                                <tr>
                                    {% include 'main-settings.block.html.twig' with {'upSell': upSell is defined ? upSell : null} %}
                                </tr>
                                <tr>
                                    {% include 'when-settings.block.html.twig' with {'upSell': upSell is defined ? upSell : null} %}
                                </tr>
                                <tr>
                                    {% include 'up-sell-settings.block.html.twig' with {'upSell': upSell is defined ? upSell : null} %}
                                </tr>
                            </tbody>
                        </table>

                        <section class="buttons-bar">
                            <section class="box buttons">
                                <button type="submit" class="btn-accept" data-icon="'">Zapisz zmiany</button>
                                <button type="reset" class="btn-cancel" data-icon="!">Anuluj</button>
                            </section>
                        </section>
                    </form>
                </section>
            </section>
        </article>
    </section>
</section>
</section>
<div id="testModal" class="modal hide fade">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h3>Modal header</h3>
    </div>
    <div class="modal-body">
        <p>One fine body…</p>
    </div>
    <div class="modal-footer">
        <a href="#" class="btn">Close</a>
        <a href="#" class="btn btn-primary">Save changes</a>
    </div>
<script src="http://www.shoplo.com/js/admin!bootstrap-admin!bootstrap.select-admin!bootstrap.checkbox-admin!jquery.custom-admin!jquery.validate-admin!jquery.sortable-admin!jquery.slimscroll-admin!jquery.numberAnimate-admin!jquery.touchtoclick-admin!admin-admin!main-11240606.js"></script>
<script src="http://www.shoplo.com/js/admin!autocompleter-0.js"></script>
<script>
    ADMIN.ROOT = 'local.up-sell.pl';
    ADMIN.STATIC_ROOT = 'local.up-sell.pl';
    ADMIN.USER = {
        ID: '0',
        TOKEN: '',
        LANG: {% if js_dict is defined %}eval(js_dict){% else %}''{% endif %},
        IC: {% if ins_com is defined and ins_com %}true{% else %}false{% endif %}
    };
    ADMIN.SHOP = {
        CURRENCY: '{% if shop is defined and shop%}{{ shop.currency }}{% endif %}'
    };

    ADMIN.run();
</script>
<script type="text/javascript">
    $(function(){
        $('#price-range-label').click(function() {

            if ($("input[name='price-range']").is(':checked'))
            {
                $("input[name='price_from']").removeAttr('disabled');
                $("input[name='price_to']").removeAttr('disabled');

            }
            else
            {
                $("input[name='price_from']").attr('disabled', 'disabled');
                $("input[name='price_to']").attr('disabled', 'disabled');
            }
        });

        $('#select-discount').change(function(){
            var selected = $('#select-discount option:selected').val();
            var html = '';
            switch(selected)
            {
                case 'percent':
                        html = $('<div class="hide"><span class="add-on">%</span><input name="discount-amount" type="text" style="height: 30px;"></div>');
                        $('.discount-container').html(html);
                        html.toggle();
                        break;

                case 'amount':
                        html = $('<div class="hide"><span class="add-on">$</span><input name="discount-amount" type="text" style="height: 30px;"</div>');
                        $('.discount-container').html(html);
                        html.toggle();
                        break;

                case 'none':
                    $('.discount-container').html('');

            }
        });

        $('#related-ac').keyup(function(){

            if ($(this).val())
            {
                $('#related-ac-result-container').removeClass('hide');
                $(this).css('border-color','#1c1f27');
                var query = $(this).val();

                var userData = {
                    'query': query
                };

                $.post('/ajax/autocomplete', userData, function (ajaxResult) {
                            if(ajaxResult.status == 'ok'){
                                $('#related-ac-result-container').find('.autocompleter-list').html(ajaxResult.html);
                            }
                        }
                        , 'json');
            }
            else
            {
                $(this).css('border-color','');
                $('#related-ac-result-container').addClass('hide');
            }
        });

        $('#up-sell-ac').keyup(function(){

            if ($(this).val())
            {
                $('#up-sell-ac-result-container').removeClass('hide');
                $(this).css('border-color','#1c1f27');
                var query = $(this).val();

                var userData = {
                    'query': query
                };

                $.post('/ajax/autocomplete', userData, function (ajaxResult) {
                            if(ajaxResult.status == 'ok'){
                                $('#up-sell-ac-result-container').find('.autocompleter-list').html(ajaxResult.html);
                            }
                        }
                        , 'json');
            }
            else
            {
                $(this).css('border-color','');
                $('#up-sell-ac-result-container').addClass('hide');
            }
        });

        $('#related-ac-result-container').on('click', 'li.item', function(){
            var imgSrc = $(this).data('thumbnail');
            var name = $(this).data('name');
            var productId = $(this).data('id');

            $('#related-ac').css('border-color','');
            $('#related-ac-result-container').addClass('hide');
            $('#related').find('ul.photos.products').append('<li class="with-handle with-meta preloaded" data-id="8"><a class="delete" data-icon="!"></a><span class="thumb-100 fade in" style="margin-top: 51px;"><img src="'+imgSrc+'"></span><section class="meta"><span class="text">'+ $.trim(name)+'</span></section><input type="hidden" name="selected-product-trigger[]" value="'+productId+'"></li>');
            $('#related-ac').val('');
        });

        $('#up-sell-ac-result-container').on('click', 'li.item', function(){
            var imgSrc = $(this).data('thumbnail');
            var name = $(this).data('name');
            var productId = $(this).data('id');

            $('#up-sell-ac').css('border-color','');
            $('#up-sell-ac-result-container').addClass('hide');
            $('#up-sell').find('ul.photos.products').append('<li class="with-handle with-meta preloaded" data-id="8"><a class="delete" data-icon="!"></a><span class="thumb-100 fade in" style="margin-top: 51px;"><img src="'+imgSrc+'"></span><section class="meta"><span class="text">'+ $.trim(name)+'</span></section><input type="hidden" name="up-sell-products[]" value="'+productId+'"></li>');
            $('#up-sell-ac').val('');
        });

    });
</script>
<script type="text/javascript">
    $(function(){

        var uppSellContainer = '<div id="up-sell-container"></div>';

        var userData = {
            'productId': {$product->id},
            'shopId': 10344,
            'cartValue':{$cart->total_price},
            'productPrice':100

        }

        $.post( "http://up-sell.mkemnitz.linuxpl.info/ajax/up-sell/product", userData, function(ajaxResult) {
            if (ajaxResult['status'] == 'ok')
            {
                $('body').append(uppSellContainer);

//                console.log(ajaxResult['html']);
                $('body').on('click','input[name="addToCard"]',function(){
                    $('#up-sell-modal').css('display','block');
                    $('#up-sell-modal').addClass('in');

                    return false;
                });

                $('body').on('click','[data-dismiss="modal"]', function(){
                    $('#up-sell-modal').removeClass('in');
                    $('#up-sell-modal').css('display','none');
                });
                $('#up-sell-container').html(ajaxResult['html']);
            }
            else if (ajaxResult['status'] == 'no up-sell')
            {

//                do nothing
            }

        }, 'json');
    });
</script>
</body>
{#<body>#}
    {#<div class="container">#}
        {#<form action="/save/" method="post">#}
            {#{% if upSell is defined %}<input name="upSellId" type="hidden" value="{{ upSell.getId() }}">{% endif %}#}
            {#<fieldset>#}
                {#<h4>Opis</h4>#}
                {#<label>Nazwa kampanii</label>#}
                {#<input name="name" type="text" placeholder="Type something…" required="required" {% if upSell is defined %}value="{{ upSell.getName() }}"{% endif %}>#}
                {#<label>Nagłówek oferty</label>#}
                {#<input name="headline" type="text" placeholder="Type something…" required="required" {% if upSell is defined %}value="{{ upSell.getHeadLine() }}"{% endif %}>#}
                {#<label>Opis oferty</label>#}
                {#<textarea name="description" required="required">{% if upSell is defined %}{{ upSell.getDescription() }}{% endif %}</textarea>#}
            {#</fieldset>#}
            {#<hr>#}
            {#<h4>Przedział cenowy</h4>#}
                {#<label class="checkbox">#}
                    {#<input id="price-range" name="price-range" type="checkbox" checked="checked"> Check me out#}
                {#</label>#}
                {#<div id="price-range-container">#}
                    {#<div class="input-prepend">#}
                        {#<span class="add-on">PLN</span>#}
                        {#<input name="price_from" class="span2" id="prependedInput" type="text" {% if upSell is defined and upSell.usePriceRane() %}value="{{ upSell.getPriceFrom() }}"{% endif %}>#}
                    {#</div>#}
                    {#<div class="input-prepend">#}
                        {#<span class="add-on">PLN</span>#}
                        {#<input name="price_to" class="span2" id="prependedInput" type="text" {% if upSell is defined and upSell.usePriceRane() %}value="{{ upSell.getPriceTo() }}"{% endif %}>#}
                    {#</div>#}
                {#</div>#}
            {#<hr>#}

            {#<h4>Gdy produkty w koszyku:</h4>#}
            {#<label class="checkbox">#}
                {#<input id="enable-in-cart" name="price-range" type="checkbox" checked="checked"> Check me out#}
            {#</label>#}

            {#<div id="cart-container">#}
                {#<select name="selected-product-trigger[]" multiple>#}
                    {#{% for product in products['products'] %}#}
                        {#<option value="{{ product['id'] }}" {% if upSell is defined and upSell.hasProductIdInCart(product['id']) %}selected="selected"{% endif %}>{{ product['name'] }}</option>#}
                    {#{% endfor %}#}
                {#</select>#}
            {#</div>#}

            {#<hr>#}

            {#<div class="hide">#}
                {#<h4>wybierz zniżke:</h4>#}
                {#<select>#}
                    {#<option value="1">1</option>#}
                    {#<option value="2">2</option>#}
                {#</select>#}

                {#<hr>#}
            {#</div>#}

            {#<div>#}
                {#<h4>Wybierz produkt:</h4>#}

                {#<select name="up-sell-products[]" multiple required="required">#}
                    {#{% for product in products['products'] %}#}
                        {#<option value="{{ product['id'] }}" {% if upSell is defined and upSell.hasRelatedProductId(product['id']) %}selected="selected"{% endif %}>{{ product['name'] }}</option>#}
                    {#{% endfor %}#}
                {#</select>#}
            {#</div>#}

            {#<button type="submit" class="btn">Submit</button>#}
        {#</form>#}
    {#</div>#}

{#</body>#}
</html>